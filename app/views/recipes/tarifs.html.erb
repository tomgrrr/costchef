<%# En-tête %>
<div class="d-flex justify-content-between align-items-center mb-4">
  <h4 class="mb-0">Tarifs</h4>
  <%= link_to recipes_path, class: "btn btn-outline-secondary" do %>
    <i class="bi bi-arrow-left"></i> Retour aux recettes
  <% end %>
</div>

<%# Onglets %>
<ul class="nav nav-tabs mb-4">
  <li class="nav-item">
    <%= link_to "Recettes", recipes_path(tab: "recipes"),
          class: "nav-link" %>
  </li>
  <li class="nav-item">
    <%= link_to "Sous-recettes", recipes_path(tab: "subrecipes"),
          class: "nav-link" %>
  </li>
  <li class="nav-item">
    <%= link_to "Tarifs", tarifs_recipes_path,
          class: "nav-link active" %>
  </li>
</ul>

<% if @recipes.any? %>
  <div class="table-responsive">
    <table class="table table-hover table-bordered align-middle">
      <thead>
        <tr>
          <th>Recette</th>
          <th>Coût de revient (€/kg)</th>
          <th>Prix de vente conseillé (€/kg)</th>
          <th>Barquette</th>
        </tr>
      </thead>
      <tbody>
        <% @recipes.each do |recipe| %>
          <tr>
            <td><%= link_to recipe.name, recipe_path(recipe) %></td>
            <td>
              <% if recipe.cached_cost_per_kg.present? && recipe.cached_cost_per_kg > 0 %>
                <%= number_with_precision(recipe.cached_cost_per_kg, precision: 2) %>&nbsp;€/kg
              <% else %>
                <span class="badge bg-warning text-dark">Non calculé</span>
              <% end %>
            </td>
            <td>
              <% if recipe.suggested_selling_price %>
                <span class="text-success fw-bold">
                  <%= number_with_precision(recipe.suggested_selling_price, precision: 2) %>&nbsp;€/kg
                </span>
              <% else %>
                &mdash;
              <% end %>
            </td>
            <td>
              <% if recipe.has_tray? && recipe.tray_size %>
                <%= recipe.tray_size.name %> — <%= number_with_precision(recipe.tray_size.price, precision: 2) %>&nbsp;€
              <% elsif recipe.has_tray? && recipe.tray_size.nil? %>
                <span class="badge bg-warning text-dark">Taille manquante</span>
              <% else %>
                &mdash;
              <% end %>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
<% else %>
  <p class="text-muted text-center mt-4">Aucune recette pour le moment.</p>
<% end %>

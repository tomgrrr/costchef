<%# Page header %>
<div class="page-header">
  <div class="d-flex align-items-center gap-3">
    <h1 class="page-title">Tarifs</h1>
    <span class="mono" style="color: var(--sl-400);"><%= @recipes.size %> recette<%= 's' if @recipes.size > 1 %></span>
  </div>
  <%= link_to recipes_path, class: "btn-outline-slate" do %>
    <i class="bi bi-arrow-left"></i> Recettes
  <% end %>
</div>

<%# Tab bar %>
<div class="tab-bar">
  <%= link_to "Recettes", recipes_path(tab: "recipes"), class: "tab-item" %>
  <%= link_to "Sous-recettes", recipes_path(tab: "subrecipes"), class: "tab-item" %>
  <%= link_to "Tarifs", tarifs_recipes_path, class: "tab-item active" %>
</div>

<%# Tarifs table %>
<div style="padding: 24px;">
  <% if @recipes.any? %>
    <div class="section-card">
      <table class="data-table">
        <thead>
          <tr>
            <th>Recette</th>
            <th>Coût de revient (€/kg)</th>
            <th>Prix de vente conseillé (€/kg)</th>
            <th>Barquette</th>
          </tr>
        </thead>
        <tbody>
          <% @recipes.each do |recipe| %>
            <tr>
              <td>
                <%= link_to recipe.name, recipe_path(recipe), style: "color: var(--sl-900); font-weight: 500; text-decoration: none;" %>
              </td>
              <td>
                <% if recipe.cached_cost_per_kg.present? && recipe.cached_cost_per_kg > 0 %>
                  <span class="mono"><%= number_with_precision(recipe.cached_cost_per_kg, precision: 2) %>&nbsp;€/kg</span>
                <% else %>
                  <span class="badge-warning-sl">Non calculé</span>
                <% end %>
              </td>
              <td>
                <% if recipe.suggested_selling_price %>
                  <span class="mono" style="color: var(--cc-success); font-weight: 600;"><%= number_with_precision(recipe.suggested_selling_price, precision: 2) %>&nbsp;€/kg</span>
                <% else %>
                  <span class="mono" style="color: var(--sl-400);">&mdash;</span>
                <% end %>
              </td>
              <td>
                <% if recipe.has_tray? && recipe.tray_size %>
                  <span class="mono"><%= recipe.tray_size.name %> (<%= number_with_precision(recipe.tray_size.price, precision: 2) %>&nbsp;€)</span>
                <% elsif recipe.has_tray? && recipe.tray_size.nil? %>
                  <span class="badge-warning-sl">Taille manquante</span>
                <% else %>
                  <span class="mono" style="color: var(--sl-400);">&mdash;</span>
                <% end %>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  <% else %>
    <p style="color: var(--sl-400); text-align: center; margin-top: 24px; font-size: 13px;">Aucune recette pour le moment.</p>
  <% end %>
</div>
